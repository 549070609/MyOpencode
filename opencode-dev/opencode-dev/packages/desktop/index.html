<!doctype html>
<html lang="en" style="background-color: var(--background-base)">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OpenCode</title>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#F8F7F7" />
    <meta name="theme-color" content="#131010" media="(prefers-color-scheme: dark)" />
    <meta property="og:image" content="/social-share.png" />
    <meta property="twitter:image" content="/social-share.png" />
    <script id="oc-theme-preload-script">
      ;(function () {
        var themeId = localStorage.getItem("opencode-theme-id")
        if (!themeId) return

        var scheme = localStorage.getItem("opencode-color-scheme") || "system"
        var isDark = scheme === "dark" || (scheme === "system" && matchMedia("(prefers-color-scheme: dark)").matches)
        var mode = isDark ? "dark" : "light"

        document.documentElement.dataset.theme = themeId
        document.documentElement.dataset.colorScheme = mode

        if (themeId === "oc-1") return

        var css = localStorage.getItem("opencode-theme-css-" + themeId + "-" + mode)
        if (css) {
          var style = document.createElement("style")
          style.id = "oc-theme-preload"
          style.textContent =
            ":root{color-scheme:" +
            mode +
            ";--text-mix-blend-mode:" +
            (isDark ? "plus-lighter" : "multiply") +
            ";" +
            css +
            "}"
          document.head.appendChild(style)
        }
      })()
    </script>
    <script id="oc-debug-preload">
      // Debug: Log __OPENCODE__ state at startup
      console.log("[HTML Preload] window.__OPENCODE__:", window.__OPENCODE__);
      console.log("[HTML Preload] location.origin:", window.location.origin);
      // Poll for __OPENCODE__ to detect when it's set
      if (!window.__OPENCODE__) {
        console.log("[HTML Preload] __OPENCODE__ not set yet, will poll...");
        var pollCount = 0;
        var pollInterval = setInterval(function() {
          pollCount++;
          if (window.__OPENCODE__) {
            console.log("[HTML Preload] __OPENCODE__ set after " + pollCount + " polls:", window.__OPENCODE__);
            clearInterval(pollInterval);
          } else if (pollCount > 100) {
            console.warn("[HTML Preload] __OPENCODE__ still not set after 100 polls!");
            clearInterval(pollInterval);
          }
        }, 50);
      }
    </script>
  </head>
  <body class="antialiased overscroll-none text-12-regular overflow-hidden">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root" class="flex flex-col h-screen"></div>
    <script src="/src/index.tsx" type="module"></script>
  </body>
</html>
