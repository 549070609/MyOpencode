# 任务工具提示词 (task.txt)

## 用途说明

任务工具提示词定义了如何使用 Task 工具启动子代理来自主处理复杂的多步骤任务。它说明了可用的代理类型、使用时机和最佳实践。

## 主要特点

- 代理类型说明
- 使用时机指南
- 并行执行支持
- 详细使用示例

---

## 完整提示词内容

```
启动新代理来自主处理复杂的多步骤任务。

可用的代理类型及其可访问的工具：
{agents}

使用 Task 工具时，您必须指定 subagent_type 参数来选择要使用的代理类型。

何时使用 Task 工具：
- 当您被指示执行自定义斜杠命令时。使用 Task 工具并将斜杠命令调用作为整个提示。斜杠命令可以带参数。例如：Task(description="检查文件", prompt="/check-file path/to/file.py")

何时不使用 Task 工具：
- 如果您想读取特定文件路径，请使用 Read 或 Glob 工具而不是 Task 工具，以更快地找到匹配项
- 如果您正在搜索特定的类定义如 "class Foo"，请使用 Glob 工具，以更快地找到匹配项
- 如果您正在特定文件或 2-3 个文件中搜索代码，请使用 Read 工具而不是 Task 工具，以更快地找到匹配项
- 与上述代理描述无关的其他任务


使用说明：
1. 尽可能同时启动多个代理以最大化性能；为此，请使用包含多个工具调用的单条消息
2. 当代理完成时，它将向您返回一条消息。代理返回的结果对用户不可见。要向用户显示结果，您应该向用户发送一条简洁摘要的文本消息。
3. 除非您提供 session_id，否则每次代理调用都是无状态的。您的提示应包含高度详细的任务描述，以便代理自主执行，并且您应该准确指定代理应在其给您的唯一最终消息中返回什么信息。
4. 代理的输出通常应该被信任
5. 明确告诉代理您是期望它编写代码还是只是进行研究（搜索、文件读取、网页获取等），因为它不知道用户的意图
6. 如果代理描述提到应该主动使用它，那么您应该尽力在用户不需要先请求的情况下使用它。请自行判断。

示例用法（注意：以下代理是仅用于说明的虚构示例 - 请使用上面列出的实际代理）：

<example_agent_descriptions>
"code-reviewer"：在您完成编写重要代码后使用此代理
"greeting-responder"：当用户问候时使用此代理以友好的笑话回应
</example_agent_description>

<example>
user: "请编写一个检查数字是否为质数的函数"
assistant: 好的，让我编写一个检查数字是否为质数的函数
assistant: 首先让我使用 Write 工具编写一个检查数字是否为质数的函数
assistant: 我将使用 Write 工具编写以下代码：
<code>
function isPrime(n) {
  if (n <= 1) return false
  for (let i = 2; i * i <= n; i++) {
    if (n % i === 0) return false
  }
  return true
}
</code>
<commentary>
由于编写了重要代码并且任务已完成，现在使用 code-reviewer 代理来审查代码
</commentary>
assistant: 现在让我使用 code-reviewer 代理来审查代码
assistant: 使用 Task 工具启动 code-reviewer 代理
</example>

<example>
user: "你好"
<commentary>
由于用户在问候，使用 greeting-responder 代理以友好的笑话回应
</commentary>
assistant: "我将使用 Task 工具启动 greeting-responder 代理"
</example>
```

---

## 关键特性

### 1. 使用时机

| 场景 | 是否使用 Task |
|------|---------------|
| 自定义斜杠命令 | ✓ 使用 |
| 读取特定文件 | ✗ 使用 Read/Glob |
| 搜索类定义 | ✗ 使用 Glob |
| 2-3 个文件搜索 | ✗ 使用 Read |
| 复杂多步骤任务 | ✓ 使用 |

### 2. 使用说明

| 规则 | 说明 |
|------|------|
| 并行执行 | 同时启动多个代理以最大化性能 |
| 结果处理 | 代理结果对用户不可见，需要总结 |
| 无状态 | 每次调用无状态，除非提供 session_id |
| 详细提示 | 提供高度详细的任务描述 |
| 信任输出 | 代理输出通常应该被信任 |
| 明确意图 | 告诉代理是编写代码还是研究 |
| 主动使用 | 如果代理描述提到主动，应主动使用 |

### 3. Task 工具参数

```
Task(
  description="任务描述",
  prompt="详细提示",
  subagent_type="代理类型"
)
```

### 4. 斜杠命令示例

```
Task(
  description="检查文件",
  prompt="/check-file path/to/file.py"
)
```

---

## 使用场景

1. **代码审查**：编写代码后启动审查代理
2. **文件搜索**：复杂的代码库搜索
3. **自定义命令**：执行用户定义的斜杠命令
4. **研究任务**：收集信息和上下文
5. **主动代理**：根据上下文自动触发

